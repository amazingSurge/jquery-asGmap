/*! jQuery asGmap - v0.1.0 - 2014-09-16
* https://github.com/amazingSurge/jquery-asGmap
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a,b,c){"use strict";var d="asGmap",e=[],f=a[d]=function(b,d){this.element=b,this.$element=a(b),this.options=a.extend({},f.defaults,d,this.$element.data()),this.namespace=this.options.namespace,this.$element.addClass(this.namespace),this.initialized=!1,this._trigger("init"),"object"==typeof c.google&&c.google.maps?this.init():(e.push(this),this.loadScript())};c.asGmapAfterScriptLoad=function(){for(var a in e)e[a].init()},f.prototype={constructor:f,loadScript:function(){var a=b.createElement("script");a.type="text/javascript",a.src=b.location.protocol+"//maps.googleapis.com/maps/api/js?"+(this.options.api_key?"key="+this.options.api_key+"&":"")+"sensor=false&callback=asGmapAfterScriptLoad",b.body.appendChild(a)},init:function(){var a=this.options,b={backgroundColor:"",center:new google.maps.LatLng(a.latitude,a.longitude),disableDefaultUI:!a.defaultUI,disableDoubleClickZoom:!a.doubleClickZoom,draggable:!0,keyboardShortcuts:!0,mapTypeControl:a.mapTypeControl,mapTypeControlOptions:{},mapTypeId:google.maps.MapTypeId[a.mapType],maxZoom:a.maxZoom,minZoom:a.minZoom,panControl:a.panControl,panControlOptions:{},rotateControl:a.rotateControl,rotateControlOptions:{},scaleControl:a.scaleControl,scaleControlOptions:{},scrollwheel:a.scrollwheel,streetViewControl:a.streetViewControl,streetViewControlOptions:{},zoom:a.zoom,zoomControl:a.zoomControl,zoomControlOptions:{}};a.controlsPositions.mapType&&(b.mapTypeControlOptions.position=a.controlsPositions.mapType),a.controlsPositions.pan&&(b.panControlOptions.position=a.controlsPositions.pan),a.controlsPositions.rotate&&(b.rotateControlOptions.position=a.controlsPositions.rotate),a.controlsPositions.scale&&(b.scaleControlOptions.position=a.controlsPositions.scale),a.controlsPositions.streetView&&(b.streetViewControlOptions.position=a.controlsPositions.streetView),a.controlsPositions.zoom&&(b.zoomControlOptions.position=a.controlsPositions.zoom),a.styles&&(b.styles=a.styles),this.map=new google.maps.Map(this.element,b),this.geocoder=new google.maps.Geocoder,a.address&&this.geocoder.geocode({address:a.address},function(a){a&&a.length&&this.gmap.setCenter(a[0].geometry.location)}),this.addMarker({latitude:a.latitude,longitude:a.longitude,address:a.address,icon:a.icon,content:a.content}),this.addMarkers(this.options.markers),this.initialized=!0,this._trigger("ready")},getMap:function(){return this.map},addMarker:function(a){function b(){var b=new google.maps.Marker(c);if(b.setMap(d.map),a.content)var e=new google.maps.InfoWindow({content:'<div class="'+d.namespace+'-content">'+a.content+"</div>"});google.maps.event.addListener(b,"click",function(){e.open(d.map,b)})}var c={},d=this;a.icon&&(c.icon={url:a.url,size:new google.maps.Size(a.icon.size[0],a.icon.size[1]),anchor:new google.maps.Point(a.icon.anchor[0],a.icon.anchor[1])}),a.hasOwnProperty("latitude")&&a.hasOwnProperty("longitude")&&a.latitude&&a.longitude?(c.position=new google.maps.LatLng(a.latitude,a.longitude),b()):a.hasOwnProperty("address")&&this.geocoder.geocode({address:a.address},function(a){a&&a.length&&(c.position=a[0].geometry.location,b())})},addMarkers:function(a){for(var b=0;b<a.length;b++)this.addMarker(a[b]);return this.markers},_trigger:function(a){var b=Array.prototype.slice.call(arguments,1),c=[this].concat(b);this.$element.trigger(d+"::"+a,c),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var e="on"+a;"function"==typeof this.options[e]&&this.options[e].apply(this,b)},destory:function(){this.$element.data(d,null),this._trigger("destory")}},f.defaults={namespace:"gmap",api_key:!1,mapType:"ROADMAP",defaultUI:!0,doubleClickZoom:!1,mapTypeControl:!0,maxZoom:null,minZoom:null,panControl:!0,rotateControl:!1,scaleControl:!1,scrollwheel:!1,streetViewControl:!0,styles:!1,zoom:3,zoomControl:!0,controlsPositions:{mapType:null,pan:null,rotate:null,scale:null,streetView:null,zoom:null},latitude:null,longitude:null,address:"",icon:{url:"http://www.google.com/mapfiles/marker.png",iconsize:[20,34],iconanchor:[9,34]},content:"",onInit:null,onReady:null},a.fn[d]=function(b){if("string"!=typeof b)return this.each(function(){a.data(this,d)||a.data(this,d,new f(this,b))});var c=b,e=Array.prototype.slice.call(arguments,1);if(/^\_/.test(c))return!1;if(!/^(get)/.test(c))return this.each(function(){var b=a.data(this,d);b&&"function"==typeof b[c]&&b[c].apply(b,e)});var g=this.first().data(d);return g&&"function"==typeof g[c]?g[c].apply(g,e):void 0}}(jQuery,document,window);