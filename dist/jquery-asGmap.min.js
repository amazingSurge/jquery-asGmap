/*! jQuery asGmap - v0.2.0 - 2014-09-15
* https://github.com/amazingSurge/jquery-asGmap
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a,b,c){"use strict";var d="asGmap",e=[],f=!1,g=a[d]=function(b,d){this.element=b,this.$element=a(b),this.options=a.extend({},g.defaults,d,this.$element.data()),this.namespace=this.options.namespace,this.$element.addClass(this.namespace),this.initialized=!1,this._trigger("init"),"object"==typeof c.google&&c.google.maps?this.init():(e.push(this),this.loadScript())};c.asGmapOnScriptLoaded=function(){for(var a in e)e[a].init()},g.prototype={constructor:g,loadScript:function(){if(!f){var a=b.createElement("script");a.type="text/javascript",a.src=b.location.protocol+"//maps.googleapis.com/maps/api/js?"+(this.options.apikey?"key="+this.options.api_key+"&":"")+"sensor=false&callback=asGmapOnScriptLoaded",b.body.appendChild(a)}},init:function(){function a(){d.map=new google.maps.Map(d.element,c),d.options.markercenter&&d.addMarker({latitude:b.latitude,longitude:b.longitude,address:b.address,content:b.content,popup:b.popup}),d.addMarkers(d.options.markers),d.initialized=!0,d._trigger("ready")}var b=this.options,c={backgroundColor:b.backgroundcolor,center:new google.maps.LatLng(b.latitude,b.longitude),disableDefaultUI:!b.defaultuI,disableDoubleClickZoom:!b.doubleclickzoom,draggable:!0,keyboardShortcuts:!0,mapTypeControl:b.maptypecontrol,mapTypeControlOptions:{},mapTypeId:google.maps.MapTypeId[b.maptype],maxZoom:b.maxzoom,minZoom:b.minzoom,panControl:b.pancontrol,panControlOptions:{},rotateControl:b.rotatecontrol,rotateControlOptions:{},scaleControl:b.scalecontrol,scaleControlOptions:{},scrollwheel:b.scrollwheel,streetViewControl:b.streetviewcontrol,streetViewControlOptions:{},zoom:b.zoom,zoomControl:b.zoomcontrol,zoomControlOptions:{}},d=this;b.controlspositions.mapType&&(c.mapTypeControlOptions.position=b.controlspositions.mapType),b.controlspositions.pan&&(c.panControlOptions.position=b.controlspositions.pan),b.controlspositions.rotate&&(c.rotateControlOptions.position=b.controlspositions.rotate),b.controlspositions.scale&&(c.scaleControlOptions.position=b.controlspositions.scale),b.controlspositions.streetView&&(c.streetViewControlOptions.position=b.controlspositions.streetView),b.controlspositions.zoom&&(c.zoomControlOptions.position=b.controlspositions.zoom),b.styles&&(c.styles=b.styles),this.geocoder=new google.maps.Geocoder,b.address?this.geocoder.geocode({address:b.address},function(b){b&&b.length&&(c.center=b[0].geometry.location),a()}):a()},getMap:function(){return this.map},addMarker:function(b){function c(){var a=new google.maps.Marker(d);if(a.setMap(e.map),b.content){var c=new google.maps.InfoWindow({content:'<div class="'+e.namespace+'-content">'+b.content+"</div>"});google.maps.event.addListener(a,"click",function(){c.open(e.map,a)}),b.popup&&c.open(e.map,a)}}var d={},e=this;b=a.extend({icon:this.options.icon,content:"",popup:!1},b),d.icon={url:b.icon.url,size:new google.maps.Size(b.icon.size[0],b.icon.size[1]),anchor:new google.maps.Point(b.icon.anchor[0],b.icon.anchor[1])},b.hasOwnProperty("latitude")&&b.hasOwnProperty("longitude")&&b.latitude&&b.longitude?(d.position=new google.maps.LatLng(b.latitude,b.longitude),c()):b.hasOwnProperty("address")&&this.geocoder.geocode({address:b.address},function(a){a&&a.length&&(d.position=a[0].geometry.location,c())})},addMarkers:function(a){for(var b=0;b<a.length;b++)this.addMarker(a[b]);return this.markers},_trigger:function(a){var b=Array.prototype.slice.call(arguments,1),c=[this].concat(b);this.$element.trigger(d+"::"+a,c),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var e="on"+a;"function"==typeof this.options[e]&&this.options[e].apply(this,b)},destory:function(){this.$element.data(d,null),this._trigger("destory")}},g.defaults={namespace:"gmap",apikey:"",mapType:"ROADMAP",backgroundcolor:"#e5e3df",defaultui:!0,doubleclickzoom:!1,maptypecontrol:!0,maxzoom:null,minzoom:null,pancontrol:!1,rotatecontrol:!1,scalecontrol:!1,scrollwheel:!1,streetviewcontrol:!1,styles:!1,zoom:3,zoomcontrol:!0,controlspositions:{mapType:null,pan:null,rotate:null,scale:null,streetView:null,zoom:null},latitude:null,longitude:null,address:"",markers:[],icon:{url:"http://www.google.com/mapfiles/marker.png",size:[20,34],anchor:[9,34]},markercenter:!0,content:"",popup:!0,onInit:null,onReady:null},a.fn[d]=function(b){if("string"!=typeof b)return this.each(function(){a.data(this,d)||a.data(this,d,new g(this,b))});var c=b,e=Array.prototype.slice.call(arguments,1);if(/^\_/.test(c))return!1;if(!/^(get)/.test(c))return this.each(function(){var b=a.data(this,d);b&&"function"==typeof b[c]&&b[c].apply(b,e)});var f=this.first().data(d);return f&&"function"==typeof f[c]?f[c].apply(f,e):void 0}}(jQuery,document,window);